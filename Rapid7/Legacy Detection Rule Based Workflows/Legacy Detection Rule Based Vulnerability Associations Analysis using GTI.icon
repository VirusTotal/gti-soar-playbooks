{
  "kom": {
    "komandVersion": "1.183.2-566936bb4",
    "komFileVersion": "2.0.0",
    "exportedAt": "2025-06-11T11:55:50.606402296Z",
    "workflowVersions": [
      {
        "name": "Legacy Detection Rule Based Vulnerability Associations Analysis using GTI",
        "type": "runnable",
        "version": "",
        "description": "",
        "graph": {
          "edges": {
            "00211dc9-1e70-4c4b-a0cc-e2dc1ad1bd76": {
              "id": "00211dc9-1e70-4c4b-a0cc-e2dc1ad1bd76",
              "name": "",
              "description": "",
              "parentNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d",
              "fromNodeId": "4541f512-1aa4-41fe-bcb9-72e34bf41e0b",
              "toNodeId": "fd67a68e-6142-4f75-aeb1-adf158800cf2"
            },
            "096c9942-eecb-49bb-8e2a-f78c92fb462b": {
              "id": "096c9942-eecb-49bb-8e2a-f78c92fb462b",
              "name": "",
              "description": "",
              "parentNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
              "fromNodeId": "cff4a42c-97bc-4511-9ffe-626ed0df1f5e",
              "toNodeId": ""
            },
            "1492bb9b-42f0-4750-994d-4876aa90e5c6": {
              "id": "1492bb9b-42f0-4750-994d-4876aa90e5c6",
              "name": "",
              "description": "",
              "parentNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
              "fromNodeId": "5d60ad77-ecad-4c0f-9b5d-f3cc83e90f60",
              "toNodeId": ""
            },
            "162f496f-6ec8-44bf-b66d-5645197a484c": {
              "id": "162f496f-6ec8-44bf-b66d-5645197a484c",
              "name": "",
              "description": "",
              "parentNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d",
              "fromNodeId": "b9f0b654-1d6c-46f0-85d6-832eac0fb2bc",
              "toNodeId": ""
            },
            "20dacfdc-8d26-4147-9fc0-d3c8a3783e5c": {
              "id": "20dacfdc-8d26-4147-9fc0-d3c8a3783e5c",
              "name": "Found",
              "description": "",
              "parentNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d",
              "fromNodeId": "fd67a68e-6142-4f75-aeb1-adf158800cf2",
              "toNodeId": "b9f0b654-1d6c-46f0-85d6-832eac0fb2bc"
            },
            "22a7cd5b-df6a-49dd-b8fe-8a3aac55efda": {
              "id": "22a7cd5b-df6a-49dd-b8fe-8a3aac55efda",
              "name": "Found",
              "description": "",
              "parentNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
              "fromNodeId": "049aada5-117f-4f76-966f-5b499150c36a",
              "toNodeId": "cff4a42c-97bc-4511-9ffe-626ed0df1f5e"
            },
            "412dbc9b-b764-44c4-b230-6e332013e559": {
              "id": "412dbc9b-b764-44c4-b230-6e332013e559",
              "name": "",
              "description": "",
              "parentNodeId": "435e05f6-d3e2-4bea-8768-2b080062819e",
              "fromNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
              "toNodeId": ""
            },
            "5294eebc-2a69-4b60-b012-ca8c4fdda1e8": {
              "id": "5294eebc-2a69-4b60-b012-ca8c4fdda1e8",
              "name": "",
              "description": "",
              "parentNodeId": "435e05f6-d3e2-4bea-8768-2b080062819e",
              "fromNodeId": "435e05f6-d3e2-4bea-8768-2b080062819e",
              "toNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1"
            },
            "55e6297e-5ad1-4762-b2ce-fe0820384074": {
              "id": "55e6297e-5ad1-4762-b2ce-fe0820384074",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
              "toNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de"
            },
            "5fe373b7-540a-4255-a503-e4cf42256e53": {
              "id": "5fe373b7-540a-4255-a503-e4cf42256e53",
              "name": "",
              "description": "",
              "parentNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d",
              "fromNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d",
              "toNodeId": "4541f512-1aa4-41fe-bcb9-72e34bf41e0b"
            },
            "6e015eea-3549-4e24-bbf2-4216b03ce861": {
              "id": "6e015eea-3549-4e24-bbf2-4216b03ce861",
              "name": "",
              "description": "",
              "parentNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
              "fromNodeId": "e415fb14-a871-483e-9c40-adbb60f0a163",
              "toNodeId": "2f8aa555-5630-4e2a-97f3-7b96e0750acd"
            },
            "70344784-6c98-42d6-8911-87d48c00c836": {
              "id": "70344784-6c98-42d6-8911-87d48c00c836",
              "name": "Not Found",
              "description": "",
              "parentNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
              "fromNodeId": "2f8aa555-5630-4e2a-97f3-7b96e0750acd",
              "toNodeId": ""
            },
            "9b666d3c-a449-4ae6-bb5f-c8afe3dd3c45": {
              "id": "9b666d3c-a449-4ae6-bb5f-c8afe3dd3c45",
              "name": "Not Found",
              "description": "",
              "parentNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d",
              "fromNodeId": "fd67a68e-6142-4f75-aeb1-adf158800cf2",
              "toNodeId": ""
            },
            "9ba6db02-1929-4325-a3ec-0d5c729ee690": {
              "id": "9ba6db02-1929-4325-a3ec-0d5c729ee690",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "435e05f6-d3e2-4bea-8768-2b080062819e",
              "toNodeId": ""
            },
            "9d64c82a-e0f8-49fc-bba7-bb10b9de10a7": {
              "id": "9d64c82a-e0f8-49fc-bba7-bb10b9de10a7",
              "name": "",
              "description": "",
              "parentNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
              "fromNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
              "toNodeId": "50ed1d78-c9b2-4c99-b153-473da8f1cf8c"
            },
            "9d9dce21-981c-41be-8115-cb0397b62495": {
              "id": "9d9dce21-981c-41be-8115-cb0397b62495",
              "name": "",
              "description": "",
              "parentNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
              "fromNodeId": "b9a0d3c7-fa23-4c96-808a-109ddf7e47b7",
              "toNodeId": ""
            },
            "a5e8191b-cf7a-4bcc-a3cc-8f85229ee557": {
              "id": "a5e8191b-cf7a-4bcc-a3cc-8f85229ee557",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d",
              "toNodeId": "435e05f6-d3e2-4bea-8768-2b080062819e"
            },
            "a9e5ef58-edfb-4917-8ad5-f36497736ef3": {
              "id": "a9e5ef58-edfb-4917-8ad5-f36497736ef3",
              "name": "Not Found",
              "description": "",
              "parentNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
              "fromNodeId": "78dcb07e-2b2e-41d7-9033-ae88f10b2d88",
              "toNodeId": ""
            },
            "af5b35f4-19c6-482d-8cbe-9f467f02aa03": {
              "id": "af5b35f4-19c6-482d-8cbe-9f467f02aa03",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d3c8f733-6e72-4eb9-aef0-d53212275c18",
              "toNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834"
            },
            "b228ddad-c168-4c71-b356-ab5ba6b9b038": {
              "id": "b228ddad-c168-4c71-b356-ab5ba6b9b038",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
              "toNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d"
            },
            "b2b072f7-87e3-4c77-b504-86126a66a5dd": {
              "id": "b2b072f7-87e3-4c77-b504-86126a66a5dd",
              "name": "Found",
              "description": "",
              "parentNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
              "fromNodeId": "78dcb07e-2b2e-41d7-9033-ae88f10b2d88",
              "toNodeId": "5d60ad77-ecad-4c0f-9b5d-f3cc83e90f60"
            },
            "b73e8b96-a9e0-49e4-90db-bbdf4e1c4461": {
              "id": "b73e8b96-a9e0-49e4-90db-bbdf4e1c4461",
              "name": "",
              "description": "",
              "parentNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
              "fromNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
              "toNodeId": "e415fb14-a871-483e-9c40-adbb60f0a163"
            },
            "cd8fcbb0-396e-444c-9711-131d2996b59f": {
              "id": "cd8fcbb0-396e-444c-9711-131d2996b59f",
              "name": "",
              "description": "",
              "parentNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
              "fromNodeId": "50ed1d78-c9b2-4c99-b153-473da8f1cf8c",
              "toNodeId": "049aada5-117f-4f76-966f-5b499150c36a"
            },
            "d5df351a-d3ad-4d1e-9c18-e6abe028be6e": {
              "id": "d5df351a-d3ad-4d1e-9c18-e6abe028be6e",
              "name": "Found",
              "description": "",
              "parentNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
              "fromNodeId": "2f8aa555-5630-4e2a-97f3-7b96e0750acd",
              "toNodeId": "b9a0d3c7-fa23-4c96-808a-109ddf7e47b7"
            },
            "e3da5ef5-939d-4eb0-b1b7-6274bc3778b9": {
              "id": "e3da5ef5-939d-4eb0-b1b7-6274bc3778b9",
              "name": "",
              "description": "",
              "parentNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
              "fromNodeId": "09f3be4a-3bd6-4c99-a1be-9294ddd9f892",
              "toNodeId": "78dcb07e-2b2e-41d7-9033-ae88f10b2d88"
            },
            "ebd8a3b2-246b-415b-a65b-e0cb01e95f93": {
              "id": "ebd8a3b2-246b-415b-a65b-e0cb01e95f93",
              "name": "",
              "description": "",
              "parentNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
              "fromNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
              "toNodeId": "09f3be4a-3bd6-4c99-a1be-9294ddd9f892"
            },
            "f5b26e2f-1e9a-442c-baa4-62e5f761b8a6": {
              "id": "f5b26e2f-1e9a-442c-baa4-62e5f761b8a6",
              "name": "Not Found",
              "description": "",
              "parentNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
              "fromNodeId": "049aada5-117f-4f76-966f-5b499150c36a",
              "toNodeId": ""
            }
          },
          "nodes": {
            "049aada5-117f-4f76-966f-5b499150c36a": {
              "id": "049aada5-117f-4f76-966f-5b499150c36a",
              "parentNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1"
            },
            "078a633f-2c8a-4962-b56a-62a7a24c06f1": {
              "id": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
              "parentNodeId": "435e05f6-d3e2-4bea-8768-2b080062819e"
            },
            "09f3be4a-3bd6-4c99-a1be-9294ddd9f892": {
              "id": "09f3be4a-3bd6-4c99-a1be-9294ddd9f892",
              "parentNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de"
            },
            "2f8aa555-5630-4e2a-97f3-7b96e0750acd": {
              "id": "2f8aa555-5630-4e2a-97f3-7b96e0750acd",
              "parentNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834"
            },
            "435e05f6-d3e2-4bea-8768-2b080062819e": {
              "id": "435e05f6-d3e2-4bea-8768-2b080062819e",
              "parentNodeId": ""
            },
            "4541f512-1aa4-41fe-bcb9-72e34bf41e0b": {
              "id": "4541f512-1aa4-41fe-bcb9-72e34bf41e0b",
              "parentNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d"
            },
            "50ed1d78-c9b2-4c99-b153-473da8f1cf8c": {
              "id": "50ed1d78-c9b2-4c99-b153-473da8f1cf8c",
              "parentNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1"
            },
            "5d60ad77-ecad-4c0f-9b5d-f3cc83e90f60": {
              "id": "5d60ad77-ecad-4c0f-9b5d-f3cc83e90f60",
              "parentNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de"
            },
            "78dcb07e-2b2e-41d7-9033-ae88f10b2d88": {
              "id": "78dcb07e-2b2e-41d7-9033-ae88f10b2d88",
              "parentNodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de"
            },
            "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de": {
              "id": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
              "parentNodeId": ""
            },
            "b9a0d3c7-fa23-4c96-808a-109ddf7e47b7": {
              "id": "b9a0d3c7-fa23-4c96-808a-109ddf7e47b7",
              "parentNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834"
            },
            "b9f0b654-1d6c-46f0-85d6-832eac0fb2bc": {
              "id": "b9f0b654-1d6c-46f0-85d6-832eac0fb2bc",
              "parentNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d"
            },
            "cb7123c3-1d1a-4c8d-b113-edc3c2f58834": {
              "id": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
              "parentNodeId": ""
            },
            "cff4a42c-97bc-4511-9ffe-626ed0df1f5e": {
              "id": "cff4a42c-97bc-4511-9ffe-626ed0df1f5e",
              "parentNodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1"
            },
            "d3c8f733-6e72-4eb9-aef0-d53212275c18": {
              "id": "d3c8f733-6e72-4eb9-aef0-d53212275c18",
              "parentNodeId": ""
            },
            "debc1bcc-82cf-442d-9b0d-d825e463932d": {
              "id": "debc1bcc-82cf-442d-9b0d-d825e463932d",
              "parentNodeId": ""
            },
            "e415fb14-a871-483e-9c40-adbb60f0a163": {
              "id": "e415fb14-a871-483e-9c40-adbb60f0a163",
              "parentNodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834"
            },
            "fd67a68e-6142-4f75-aeb1-adf158800cf2": {
              "id": "fd67a68e-6142-4f75-aeb1-adf158800cf2",
              "parentNodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d"
            }
          }
        },
        "steps": {
          "049aada5-117f-4f76-966f-5b499150c36a": {
            "nodeId": "049aada5-117f-4f76-966f-5b499150c36a",
            "name": "File Hash Vulnerability Associations Found ?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "f5b26e2f-1e9a-442c-baa4-62e5f761b8a6",
              "stepControlParams": [
                {
                  "edgeId": "22a7cd5b-df6a-49dd-b8fe-8a3aac55efda",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "50ed1d78-c9b2-4c99-b153-473da8f1cf8c.vulnerability_associations",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[50ed1d78-c9b2-4c99-b153-473da8f1cf8c].[vulnerability_associations]}}) > 0"
                },
                {
                  "edgeId": "f5b26e2f-1e9a-442c-baa4-62e5f761b8a6",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "078a633f-2c8a-4962-b56a-62a7a24c06f1": {
            "nodeId": "078a633f-2c8a-4962-b56a-62a7a24c06f1",
            "name": "File Hashes Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "9d64c82a-e0f8-49fc-bba7-bb10b9de10a7",
              "nextEdgeId": "412dbc9b-b764-44c4-b230-6e332013e559",
              "repeatVariable": "{{[435e05f6-d3e2-4bea-8768-2b080062819e].[$item].[hashes]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "09f3be4a-3bd6-4c99-a1be-9294ddd9f892": {
            "nodeId": "09f3be4a-3bd6-4c99-a1be-9294ddd9f892",
            "name": "Get Domain Vulnerability Associations ",
            "type": "action",
            "plugin": {
              "name": "Google Threat Intelligence",
              "slugVendor": "google_threat_intelligence",
              "slugName": "google_threat_intelligence",
              "slugVersion": "2.0.0",
              "imageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "get_vulnerability_associations",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "ioc_type": "Domain",
                "ioc_value": "{{[93b9bc1e-3f39-404b-bc3e-eb8f7fc027de].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "ioc_type": {
                  "description": "Select the type of the IOC (IP Address, Domain, URL, or File Hash)",
                  "enum": [
                    "IP Address",
                    "Domain",
                    "Url",
                    "File Hash"
                  ],
                  "order": 1,
                  "title": "IOC Type",
                  "type": "string"
                },
                "ioc_value": {
                  "description": "The value of the specified IOC for which the vulnerability report should be retrieved",
                  "order": 2,
                  "title": "IOC Value",
                  "type": "string"
                }
              },
              "required": [
                "ioc_value",
                "ioc_type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "vulnerability_association": {
                  "properties": {
                    "available_mitigation": {
                      "description": "List of available ways to reduce / mitigate the vulnerability",
                      "order": 1,
                      "title": "Available Mitigation",
                      "type": "string"
                    },
                    "collection_type": {
                      "description": "Identifies the type of the object. For vulnerabilities the value of this attribute is vulnerability",
                      "order": 8,
                      "title": "Collection Type",
                      "type": "string"
                    },
                    "counters": {
                      "description": "Dictionary of counters of related objects",
                      "order": 3,
                      "title": "Counters",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Vulnerability object creation date",
                      "order": 13,
                      "title": "Creation Date",
                      "type": "string"
                    },
                    "cve_id": {
                      "description": "Vulnerability CVE standard identifier",
                      "order": 2,
                      "title": "CVE ID",
                      "type": "string"
                    },
                    "cvss": {
                      "description": "Containing Common Vulnerability Scoring System (CVSS) data used to assess the severity of vulnerabilities, including scores and vectors from different CVSS versions (v2, v3, v4)",
                      "order": 4,
                      "title": "CVSS",
                      "type": "object"
                    },
                    "cwe": {
                      "description": "Vulnerability information from Common Weakness Enumeration (CWE)",
                      "order": 19,
                      "title": "CWE",
                      "type": "object"
                    },
                    "date_of_disclosure": {
                      "description": "Vulnerability disclosure date",
                      "order": 18,
                      "title": "Date of Disclosure",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description / context about the vulnerability",
                      "order": 9,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Vulnerability ID",
                      "order": 6,
                      "title": "ID",
                      "type": "string"
                    },
                    "last_modification_date": {
                      "description": "Last time when the vulnerability's information was updated",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "string"
                    },
                    "name": {
                      "description": "Vulnerability's name",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "origin": {
                      "description": "Identifies the source of the information. Google Threat Intelligence for curated objects from our Google TI experts",
                      "order": 7,
                      "title": "Origin",
                      "type": "string"
                    },
                    "predicted_risk_rating": {
                      "description": "Vulnerability's predicted risk rating. Possible values is Low, Medium, High, None",
                      "order": 22,
                      "title": "Predicted Risk Rating",
                      "type": "string"
                    },
                    "priority": {
                      "description": "The Priority rating combines Exploitation State, Exploit Availability, and Risk Rating into a P0-P4 scale to help prioritize vulnerability remediation, with P0 as the most critical",
                      "order": 20,
                      "title": "Priority",
                      "type": "string"
                    },
                    "private": {
                      "description": "Whether the vulnerability object is private or not",
                      "order": 23,
                      "title": "Private",
                      "type": "boolean"
                    },
                    "risk_rating": {
                      "description": "Risk rating of the vulnerability. Possible values is Low, Medium, High, Critical, Unrated",
                      "order": 17,
                      "title": "Risk Rating",
                      "type": "string"
                    },
                    "source_regions_hierarchy": {
                      "description": "Country or region from which the vulnerability is known to originate",
                      "order": 11,
                      "title": "Source Regions Hierarchy",
                      "type": "string"
                    },
                    "status": {
                      "description": "Indicates if the object has attributes pending to be computed again",
                      "order": 16,
                      "title": "Status",
                      "type": "string"
                    },
                    "summary_stats": {
                      "description": "Provides aggregated statistics (min, max, avg) about submissions and detections for a set of files, including first/last submission dates and detection counts",
                      "order": 15,
                      "title": "Summary Stats",
                      "type": "object"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "order": 21,
                      "title": "Tags",
                      "type": "string"
                    },
                    "targeted_industries_tree": {
                      "description": "List of industries and industry groups known to be targeted by the vulnerability's exploits",
                      "order": 12,
                      "title": "Targeted Industries Tree",
                      "type": "string"
                    },
                    "targeted_regions_hierarchy": {
                      "description": "List of regions and countries known to be targeted by the vulnerability",
                      "order": 10,
                      "title": "Targeted Regions Hierarchy",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability Association",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerability_associations": {
                  "description": "Contains a list of vulnerability objects provide curated information to help with patching prioritization and vulnerability mitigation, reducing companies exposure",
                  "items": {
                    "$ref": "#/definitions/vulnerability_association"
                  },
                  "order": 1,
                  "title": "Vulnerability Associations",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "2f8aa555-5630-4e2a-97f3-7b96e0750acd": {
            "nodeId": "2f8aa555-5630-4e2a-97f3-7b96e0750acd",
            "name": "IP Address Vulnerability Associations Found ?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "70344784-6c98-42d6-8911-87d48c00c836",
              "stepControlParams": [
                {
                  "edgeId": "d5df351a-d3ad-4d1e-9c18-e6abe028be6e",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "e415fb14-a871-483e-9c40-adbb60f0a163.vulnerability_associations",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[e415fb14-a871-483e-9c40-adbb60f0a163].[vulnerability_associations]}}) > 0"
                },
                {
                  "edgeId": "70344784-6c98-42d6-8911-87d48c00c836",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "435e05f6-d3e2-4bea-8768-2b080062819e": {
            "nodeId": "435e05f6-d3e2-4bea-8768-2b080062819e",
            "name": "Processes Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "5294eebc-2a69-4b60-b012-ca8c4fdda1e8",
              "nextEdgeId": "9ba6db02-1929-4325-a3ec-0d5c729ee690",
              "repeatVariable": "{{[d3c8f733-6e72-4eb9-aef0-d53212275c18].[contents].[processes]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "4541f512-1aa4-41fe-bcb9-72e34bf41e0b": {
            "nodeId": "4541f512-1aa4-41fe-bcb9-72e34bf41e0b",
            "name": "Get URL Vulnerability Associations ",
            "type": "action",
            "plugin": {
              "name": "Google Threat Intelligence",
              "slugVendor": "google_threat_intelligence",
              "slugName": "google_threat_intelligence",
              "slugVersion": "2.0.0",
              "imageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "get_vulnerability_associations",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "ioc_type": "Url",
                "ioc_value": "{{[debc1bcc-82cf-442d-9b0d-d825e463932d].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "ioc_type": {
                  "description": "Select the type of the IOC (IP Address, Domain, URL, or File Hash)",
                  "enum": [
                    "IP Address",
                    "Domain",
                    "Url",
                    "File Hash"
                  ],
                  "order": 1,
                  "title": "IOC Type",
                  "type": "string"
                },
                "ioc_value": {
                  "description": "The value of the specified IOC for which the vulnerability report should be retrieved",
                  "order": 2,
                  "title": "IOC Value",
                  "type": "string"
                }
              },
              "required": [
                "ioc_value",
                "ioc_type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "vulnerability_association": {
                  "properties": {
                    "available_mitigation": {
                      "description": "List of available ways to reduce / mitigate the vulnerability",
                      "order": 1,
                      "title": "Available Mitigation",
                      "type": "string"
                    },
                    "collection_type": {
                      "description": "Identifies the type of the object. For vulnerabilities the value of this attribute is vulnerability",
                      "order": 8,
                      "title": "Collection Type",
                      "type": "string"
                    },
                    "counters": {
                      "description": "Dictionary of counters of related objects",
                      "order": 3,
                      "title": "Counters",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Vulnerability object creation date",
                      "order": 13,
                      "title": "Creation Date",
                      "type": "string"
                    },
                    "cve_id": {
                      "description": "Vulnerability CVE standard identifier",
                      "order": 2,
                      "title": "CVE ID",
                      "type": "string"
                    },
                    "cvss": {
                      "description": "Containing Common Vulnerability Scoring System (CVSS) data used to assess the severity of vulnerabilities, including scores and vectors from different CVSS versions (v2, v3, v4)",
                      "order": 4,
                      "title": "CVSS",
                      "type": "object"
                    },
                    "cwe": {
                      "description": "Vulnerability information from Common Weakness Enumeration (CWE)",
                      "order": 19,
                      "title": "CWE",
                      "type": "object"
                    },
                    "date_of_disclosure": {
                      "description": "Vulnerability disclosure date",
                      "order": 18,
                      "title": "Date of Disclosure",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description / context about the vulnerability",
                      "order": 9,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Vulnerability ID",
                      "order": 6,
                      "title": "ID",
                      "type": "string"
                    },
                    "last_modification_date": {
                      "description": "Last time when the vulnerability's information was updated",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "string"
                    },
                    "name": {
                      "description": "Vulnerability's name",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "origin": {
                      "description": "Identifies the source of the information. Google Threat Intelligence for curated objects from our Google TI experts",
                      "order": 7,
                      "title": "Origin",
                      "type": "string"
                    },
                    "predicted_risk_rating": {
                      "description": "Vulnerability's predicted risk rating. Possible values is Low, Medium, High, None",
                      "order": 22,
                      "title": "Predicted Risk Rating",
                      "type": "string"
                    },
                    "priority": {
                      "description": "The Priority rating combines Exploitation State, Exploit Availability, and Risk Rating into a P0-P4 scale to help prioritize vulnerability remediation, with P0 as the most critical",
                      "order": 20,
                      "title": "Priority",
                      "type": "string"
                    },
                    "private": {
                      "description": "Whether the vulnerability object is private or not",
                      "order": 23,
                      "title": "Private",
                      "type": "boolean"
                    },
                    "risk_rating": {
                      "description": "Risk rating of the vulnerability. Possible values is Low, Medium, High, Critical, Unrated",
                      "order": 17,
                      "title": "Risk Rating",
                      "type": "string"
                    },
                    "source_regions_hierarchy": {
                      "description": "Country or region from which the vulnerability is known to originate",
                      "order": 11,
                      "title": "Source Regions Hierarchy",
                      "type": "string"
                    },
                    "status": {
                      "description": "Indicates if the object has attributes pending to be computed again",
                      "order": 16,
                      "title": "Status",
                      "type": "string"
                    },
                    "summary_stats": {
                      "description": "Provides aggregated statistics (min, max, avg) about submissions and detections for a set of files, including first/last submission dates and detection counts",
                      "order": 15,
                      "title": "Summary Stats",
                      "type": "object"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "order": 21,
                      "title": "Tags",
                      "type": "string"
                    },
                    "targeted_industries_tree": {
                      "description": "List of industries and industry groups known to be targeted by the vulnerability's exploits",
                      "order": 12,
                      "title": "Targeted Industries Tree",
                      "type": "string"
                    },
                    "targeted_regions_hierarchy": {
                      "description": "List of regions and countries known to be targeted by the vulnerability",
                      "order": 10,
                      "title": "Targeted Regions Hierarchy",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability Association",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerability_associations": {
                  "description": "Contains a list of vulnerability objects provide curated information to help with patching prioritization and vulnerability mitigation, reducing companies exposure",
                  "items": {
                    "$ref": "#/definitions/vulnerability_association"
                  },
                  "order": 1,
                  "title": "Vulnerability Associations",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "50ed1d78-c9b2-4c99-b153-473da8f1cf8c": {
            "nodeId": "50ed1d78-c9b2-4c99-b153-473da8f1cf8c",
            "name": "Get File Hash Vulnerability Associations",
            "type": "action",
            "plugin": {
              "name": "Google Threat Intelligence",
              "slugVendor": "google_threat_intelligence",
              "slugName": "google_threat_intelligence",
              "slugVersion": "2.0.0",
              "imageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "get_vulnerability_associations",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "ioc_type": "File Hash",
                "ioc_value": "{{[078a633f-2c8a-4962-b56a-62a7a24c06f1].[$item].[hash]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "ioc_type": {
                  "description": "Select the type of the IOC (IP Address, Domain, URL, or File Hash)",
                  "enum": [
                    "IP Address",
                    "Domain",
                    "Url",
                    "File Hash"
                  ],
                  "order": 1,
                  "title": "IOC Type",
                  "type": "string"
                },
                "ioc_value": {
                  "description": "The value of the specified IOC for which the vulnerability report should be retrieved",
                  "order": 2,
                  "title": "IOC Value",
                  "type": "string"
                }
              },
              "required": [
                "ioc_value",
                "ioc_type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "vulnerability_association": {
                  "properties": {
                    "available_mitigation": {
                      "description": "List of available ways to reduce / mitigate the vulnerability",
                      "order": 1,
                      "title": "Available Mitigation",
                      "type": "string"
                    },
                    "collection_type": {
                      "description": "Identifies the type of the object. For vulnerabilities the value of this attribute is vulnerability",
                      "order": 8,
                      "title": "Collection Type",
                      "type": "string"
                    },
                    "counters": {
                      "description": "Dictionary of counters of related objects",
                      "order": 3,
                      "title": "Counters",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Vulnerability object creation date",
                      "order": 13,
                      "title": "Creation Date",
                      "type": "string"
                    },
                    "cve_id": {
                      "description": "Vulnerability CVE standard identifier",
                      "order": 2,
                      "title": "CVE ID",
                      "type": "string"
                    },
                    "cvss": {
                      "description": "Containing Common Vulnerability Scoring System (CVSS) data used to assess the severity of vulnerabilities, including scores and vectors from different CVSS versions (v2, v3, v4)",
                      "order": 4,
                      "title": "CVSS",
                      "type": "object"
                    },
                    "cwe": {
                      "description": "Vulnerability information from Common Weakness Enumeration (CWE)",
                      "order": 19,
                      "title": "CWE",
                      "type": "object"
                    },
                    "date_of_disclosure": {
                      "description": "Vulnerability disclosure date",
                      "order": 18,
                      "title": "Date of Disclosure",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description / context about the vulnerability",
                      "order": 9,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Vulnerability ID",
                      "order": 6,
                      "title": "ID",
                      "type": "string"
                    },
                    "last_modification_date": {
                      "description": "Last time when the vulnerability's information was updated",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "string"
                    },
                    "name": {
                      "description": "Vulnerability's name",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "origin": {
                      "description": "Identifies the source of the information. Google Threat Intelligence for curated objects from our Google TI experts",
                      "order": 7,
                      "title": "Origin",
                      "type": "string"
                    },
                    "predicted_risk_rating": {
                      "description": "Vulnerability's predicted risk rating. Possible values is Low, Medium, High, None",
                      "order": 22,
                      "title": "Predicted Risk Rating",
                      "type": "string"
                    },
                    "priority": {
                      "description": "The Priority rating combines Exploitation State, Exploit Availability, and Risk Rating into a P0-P4 scale to help prioritize vulnerability remediation, with P0 as the most critical",
                      "order": 20,
                      "title": "Priority",
                      "type": "string"
                    },
                    "private": {
                      "description": "Whether the vulnerability object is private or not",
                      "order": 23,
                      "title": "Private",
                      "type": "boolean"
                    },
                    "risk_rating": {
                      "description": "Risk rating of the vulnerability. Possible values is Low, Medium, High, Critical, Unrated",
                      "order": 17,
                      "title": "Risk Rating",
                      "type": "string"
                    },
                    "source_regions_hierarchy": {
                      "description": "Country or region from which the vulnerability is known to originate",
                      "order": 11,
                      "title": "Source Regions Hierarchy",
                      "type": "string"
                    },
                    "status": {
                      "description": "Indicates if the object has attributes pending to be computed again",
                      "order": 16,
                      "title": "Status",
                      "type": "string"
                    },
                    "summary_stats": {
                      "description": "Provides aggregated statistics (min, max, avg) about submissions and detections for a set of files, including first/last submission dates and detection counts",
                      "order": 15,
                      "title": "Summary Stats",
                      "type": "object"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "order": 21,
                      "title": "Tags",
                      "type": "string"
                    },
                    "targeted_industries_tree": {
                      "description": "List of industries and industry groups known to be targeted by the vulnerability's exploits",
                      "order": 12,
                      "title": "Targeted Industries Tree",
                      "type": "string"
                    },
                    "targeted_regions_hierarchy": {
                      "description": "List of regions and countries known to be targeted by the vulnerability",
                      "order": 10,
                      "title": "Targeted Regions Hierarchy",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability Association",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerability_associations": {
                  "description": "Contains a list of vulnerability objects provide curated information to help with patching prioritization and vulnerability mitigation, reducing companies exposure",
                  "items": {
                    "$ref": "#/definitions/vulnerability_association"
                  },
                  "order": 1,
                  "title": "Vulnerability Associations",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "5d60ad77-ecad-4c0f-9b5d-f3cc83e90f60": {
            "nodeId": "5d60ad77-ecad-4c0f-9b5d-f3cc83e90f60",
            "name": "Send Domain Vulnerability Associations to IDR",
            "type": "action",
            "plugin": {
              "name": "Google Threat Intelligence",
              "slugVendor": "google_threat_intelligence",
              "slugName": "google_threat_intelligence",
              "slugVersion": "2.0.0",
              "imageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "send_events_via_webhook",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "send_events": "{{[09f3be4a-3bd6-4c99-a1be-9294ddd9f892].[vulnerability_associations]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "send_events": {
                  "description": "Provide the event in the form of array",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "Send Events",
                  "type": "array"
                }
              },
              "required": [
                "send_events"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "78dcb07e-2b2e-41d7-9033-ae88f10b2d88": {
            "nodeId": "78dcb07e-2b2e-41d7-9033-ae88f10b2d88",
            "name": "Domain Vulnerability Associations Found ?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "a9e5ef58-edfb-4917-8ad5-f36497736ef3",
              "stepControlParams": [
                {
                  "edgeId": "b2b072f7-87e3-4c77-b504-86126a66a5dd",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "09f3be4a-3bd6-4c99-a1be-9294ddd9f892.vulnerability_associations",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[09f3be4a-3bd6-4c99-a1be-9294ddd9f892].[vulnerability_associations]}}) > 0"
                },
                {
                  "edgeId": "a9e5ef58-edfb-4917-8ad5-f36497736ef3",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de": {
            "nodeId": "93b9bc1e-3f39-404b-bc3e-eb8f7fc027de",
            "name": "Domains Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "ebd8a3b2-246b-415b-a65b-e0cb01e95f93",
              "nextEdgeId": "b228ddad-c168-4c71-b356-ab5ba6b9b038",
              "repeatVariable": "{{[d3c8f733-6e72-4eb9-aef0-d53212275c18].[contents].[domains]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "b9a0d3c7-fa23-4c96-808a-109ddf7e47b7": {
            "nodeId": "b9a0d3c7-fa23-4c96-808a-109ddf7e47b7",
            "name": "Send IP Address Vulnerability Associations to IDR",
            "type": "action",
            "plugin": {
              "name": "Google Threat Intelligence",
              "slugVendor": "google_threat_intelligence",
              "slugName": "google_threat_intelligence",
              "slugVersion": "2.0.0",
              "imageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "send_events_via_webhook",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "send_events": "{{[e415fb14-a871-483e-9c40-adbb60f0a163].[vulnerability_associations]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "send_events": {
                  "description": "Provide the event in the form of array",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "Send Events",
                  "type": "array"
                }
              },
              "required": [
                "send_events"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "b9f0b654-1d6c-46f0-85d6-832eac0fb2bc": {
            "nodeId": "b9f0b654-1d6c-46f0-85d6-832eac0fb2bc",
            "name": "Send URL Vulnerability Associations to IDR",
            "type": "action",
            "plugin": {
              "name": "Google Threat Intelligence",
              "slugVendor": "google_threat_intelligence",
              "slugName": "google_threat_intelligence",
              "slugVersion": "2.0.0",
              "imageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "send_events_via_webhook",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "send_events": "{{[4541f512-1aa4-41fe-bcb9-72e34bf41e0b].[vulnerability_associations]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "send_events": {
                  "description": "Provide the event in the form of array",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "Send Events",
                  "type": "array"
                }
              },
              "required": [
                "send_events"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "cb7123c3-1d1a-4c8d-b113-edc3c2f58834": {
            "nodeId": "cb7123c3-1d1a-4c8d-b113-edc3c2f58834",
            "name": "IP Addresses Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "b73e8b96-a9e0-49e4-90db-bbdf4e1c4461",
              "nextEdgeId": "55e6297e-5ad1-4762-b2ce-fe0820384074",
              "repeatVariable": "{{[d3c8f733-6e72-4eb9-aef0-d53212275c18].[contents].[ipAddresses]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "cff4a42c-97bc-4511-9ffe-626ed0df1f5e": {
            "nodeId": "cff4a42c-97bc-4511-9ffe-626ed0df1f5e",
            "name": "Send File Hash Vulnerability Associations to IDR",
            "type": "action",
            "plugin": {
              "name": "Google Threat Intelligence",
              "slugVendor": "google_threat_intelligence",
              "slugName": "google_threat_intelligence",
              "slugVersion": "2.0.0",
              "imageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "send_events_via_webhook",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "send_events": "{{[50ed1d78-c9b2-4c99-b153-473da8f1cf8c].[vulnerability_associations]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "send_events": {
                  "description": "Provide the event in the form of array",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "Send Events",
                  "type": "array"
                }
              },
              "required": [
                "send_events"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "d3c8f733-6e72-4eb9-aef0-d53212275c18": {
            "nodeId": "d3c8f733-6e72-4eb9-aef0-d53212275c18",
            "name": "Legacy Detection Rule",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "aa7b9d01-9a3b-4182-9033-49c1a125e0c0",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IPAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IPAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "debc1bcc-82cf-442d-9b0d-d825e463932d": {
            "nodeId": "debc1bcc-82cf-442d-9b0d-d825e463932d",
            "name": "URLs Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "5fe373b7-540a-4255-a503-e4cf42256e53",
              "nextEdgeId": "a5e8191b-cf7a-4bcc-a3cc-8f85229ee557",
              "repeatVariable": "{{[d3c8f733-6e72-4eb9-aef0-d53212275c18].[contents].[urls]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "e415fb14-a871-483e-9c40-adbb60f0a163": {
            "nodeId": "e415fb14-a871-483e-9c40-adbb60f0a163",
            "name": "Get IP Address Vulnerability Associations",
            "type": "action",
            "plugin": {
              "name": "Google Threat Intelligence",
              "slugVendor": "google_threat_intelligence",
              "slugName": "google_threat_intelligence",
              "slugVersion": "2.0.0",
              "imageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "get_vulnerability_associations",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "ioc_type": "IP Address",
                "ioc_value": "{{[cb7123c3-1d1a-4c8d-b113-edc3c2f58834].[$item].[ip]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "ioc_type": {
                  "description": "Select the type of the IOC (IP Address, Domain, URL, or File Hash)",
                  "enum": [
                    "IP Address",
                    "Domain",
                    "Url",
                    "File Hash"
                  ],
                  "order": 1,
                  "title": "IOC Type",
                  "type": "string"
                },
                "ioc_value": {
                  "description": "The value of the specified IOC for which the vulnerability report should be retrieved",
                  "order": 2,
                  "title": "IOC Value",
                  "type": "string"
                }
              },
              "required": [
                "ioc_value",
                "ioc_type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "vulnerability_association": {
                  "properties": {
                    "available_mitigation": {
                      "description": "List of available ways to reduce / mitigate the vulnerability",
                      "order": 1,
                      "title": "Available Mitigation",
                      "type": "string"
                    },
                    "collection_type": {
                      "description": "Identifies the type of the object. For vulnerabilities the value of this attribute is vulnerability",
                      "order": 8,
                      "title": "Collection Type",
                      "type": "string"
                    },
                    "counters": {
                      "description": "Dictionary of counters of related objects",
                      "order": 3,
                      "title": "Counters",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Vulnerability object creation date",
                      "order": 13,
                      "title": "Creation Date",
                      "type": "string"
                    },
                    "cve_id": {
                      "description": "Vulnerability CVE standard identifier",
                      "order": 2,
                      "title": "CVE ID",
                      "type": "string"
                    },
                    "cvss": {
                      "description": "Containing Common Vulnerability Scoring System (CVSS) data used to assess the severity of vulnerabilities, including scores and vectors from different CVSS versions (v2, v3, v4)",
                      "order": 4,
                      "title": "CVSS",
                      "type": "object"
                    },
                    "cwe": {
                      "description": "Vulnerability information from Common Weakness Enumeration (CWE)",
                      "order": 19,
                      "title": "CWE",
                      "type": "object"
                    },
                    "date_of_disclosure": {
                      "description": "Vulnerability disclosure date",
                      "order": 18,
                      "title": "Date of Disclosure",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description / context about the vulnerability",
                      "order": 9,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Vulnerability ID",
                      "order": 6,
                      "title": "ID",
                      "type": "string"
                    },
                    "last_modification_date": {
                      "description": "Last time when the vulnerability's information was updated",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "string"
                    },
                    "name": {
                      "description": "Vulnerability's name",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "origin": {
                      "description": "Identifies the source of the information. Google Threat Intelligence for curated objects from our Google TI experts",
                      "order": 7,
                      "title": "Origin",
                      "type": "string"
                    },
                    "predicted_risk_rating": {
                      "description": "Vulnerability's predicted risk rating. Possible values is Low, Medium, High, None",
                      "order": 22,
                      "title": "Predicted Risk Rating",
                      "type": "string"
                    },
                    "priority": {
                      "description": "The Priority rating combines Exploitation State, Exploit Availability, and Risk Rating into a P0-P4 scale to help prioritize vulnerability remediation, with P0 as the most critical",
                      "order": 20,
                      "title": "Priority",
                      "type": "string"
                    },
                    "private": {
                      "description": "Whether the vulnerability object is private or not",
                      "order": 23,
                      "title": "Private",
                      "type": "boolean"
                    },
                    "risk_rating": {
                      "description": "Risk rating of the vulnerability. Possible values is Low, Medium, High, Critical, Unrated",
                      "order": 17,
                      "title": "Risk Rating",
                      "type": "string"
                    },
                    "source_regions_hierarchy": {
                      "description": "Country or region from which the vulnerability is known to originate",
                      "order": 11,
                      "title": "Source Regions Hierarchy",
                      "type": "string"
                    },
                    "status": {
                      "description": "Indicates if the object has attributes pending to be computed again",
                      "order": 16,
                      "title": "Status",
                      "type": "string"
                    },
                    "summary_stats": {
                      "description": "Provides aggregated statistics (min, max, avg) about submissions and detections for a set of files, including first/last submission dates and detection counts",
                      "order": 15,
                      "title": "Summary Stats",
                      "type": "object"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "order": 21,
                      "title": "Tags",
                      "type": "string"
                    },
                    "targeted_industries_tree": {
                      "description": "List of industries and industry groups known to be targeted by the vulnerability's exploits",
                      "order": 12,
                      "title": "Targeted Industries Tree",
                      "type": "string"
                    },
                    "targeted_regions_hierarchy": {
                      "description": "List of regions and countries known to be targeted by the vulnerability",
                      "order": 10,
                      "title": "Targeted Regions Hierarchy",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability Association",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerability_associations": {
                  "description": "Contains a list of vulnerability objects provide curated information to help with patching prioritization and vulnerability mitigation, reducing companies exposure",
                  "items": {
                    "$ref": "#/definitions/vulnerability_association"
                  },
                  "order": 1,
                  "title": "Vulnerability Associations",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "fd67a68e-6142-4f75-aeb1-adf158800cf2": {
            "nodeId": "fd67a68e-6142-4f75-aeb1-adf158800cf2",
            "name": "URL Vulnerability Associations Found ?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "9b666d3c-a449-4ae6-bb5f-c8afe3dd3c45",
              "stepControlParams": [
                {
                  "edgeId": "20dacfdc-8d26-4147-9fc0-d3c8a3783e5c",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "4541f512-1aa4-41fe-bcb9-72e34bf41e0b.vulnerability_associations",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[4541f512-1aa4-41fe-bcb9-72e34bf41e0b].[vulnerability_associations]}}) > 0"
                },
                {
                  "edgeId": "9b666d3c-a449-4ae6-bb5f-c8afe3dd3c45",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us3.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          }
        },
        "tags": [
          "Legacy Detection Rule",
          "Vulnerability Associations"
        ],
        "humanCostSeconds": 5400,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": "Retrieves vulnerability intelligence for the specified IOC (IP Address / domain / URL / File Hash) including associated CVEs, risk ratings, targeted industries and regions, and other contextual threat metadata. Vulnerability objects provide curated information to assist with patching prioritization and mitigation, helping reduce a company's exposure."
      }
    ],
    "triggers": [
      {
        "id": "aa7b9d01-9a3b-4182-9033-49c1a125e0c0",
        "name": "Legacy Detection Rule",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IPAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IPAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}